\usepackage[onehalfspacing]{setspace}
\usepackage{geometry} % Used to include [margin=0.6in], but that's dumb to have here. Use \geometry{margin=blah} in your document to set margin length
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{mathrsfs}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{tikz}
\usepackage{tikz-cd}
\usepackage{listings}
\usepackage{color}
\usepackage{enumitem}
\usepackage{imakeidx}
\usepackage[colorinlistoftodos]{todonotes}
\usepackage{upgreek}
\usepackage{hyperref}
\usepackage{mdframed}
\usepackage{pgfplots}
\usepackage{manfnt}
%\usepackage{calrsfs}
\usepackage[new]{old-arrows}
\usepackage{changepage}
\usepackage{stmaryrd}
\usepackage{appendix}
\usepackage[normalem]{ulem}
\usepackage{ytableau}
\usepackage{blkarray}
\usepackage{mathtools}
\usepackage{verbatim}

% https://tex.stackexchange.com/questions/69085/two-different-calligraphic-font-styles-in-math-mode
% calrsfs messes with mathcal. This makes pazocal what mathcal usually is
%\DeclareMathAlphabet{\pazocal}{OMS}{zplm}{m}{n}

% Euler Script font
% https://ctan.org/pkg/euler?lang=en
\DeclareMathAlphabet{\matheuler}{U}{eus}{m}{n}

%% lists
%\setlist[itemize]{align=left} % only looks good when bullets replaced by long labels
\setlist[enumerate]{align=right, label=\llap{\bfseries{(\arabic*)}}}
%\setlist[enumerate,1]{label=\llap{\bfseries{(\arabic*)}}}
%\setlist[enumerate,2]{label=\llap{\bfseries{(\arabic{enumi}.\arabic*)}}}
%\setlist[enumerate,3]{label=\llap{\bfseries{(\arabic{enumi}.\arabic{enumii}.\roman*)}}}

\newenvironment{alphabetize}{\begin{enumerate}[label=\llap{\bfseries{(\alph*)}}]}{\end{enumerate}}
\newenvironment{romanize}{\begin{enumerate}[label=\llap{\bfseries{(\roman*)}}]}{\end{enumerate}}

\pgfplotsset{width=7cm,compat=1.9}

\makeindex[intoc]

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
	backgroundcolor=\color{backcolour},   
	commentstyle=\color{codegreen},
	keywordstyle=\color{magenta},
	numberstyle=\tiny\color{codegray},
	stringstyle=\color{codepurple},
	basicstyle=\footnotesize,
	breakatwhitespace=false,         
	breaklines=true,                 
	captionpos=b,                    
	keepspaces=true,                 
	numbers=left,                    
	numbersep=5pt,                  
	showspaces=false,                
	showstringspaces=false,
	showtabs=false,                  
	tabsize=2
}

\lstset{style=mystyle}
\newcommand{\includecode}[1]{\newpage
	\hfill\textbf{#1}
	\lstinputlisting[language=python]{code/#1}}
\newcommand{\includecodesnippet}[1]{\lstinputlisting[language=python]{code/#1}}

\allowdisplaybreaks
%\linespread{1.272}  % sqrt(golden ratio) for aesthetic reasons

%% Below are very ill-defined categories

%% Linear Algebra
\newcommand{\angled}[2]{\left\langle#1,#2\right\rangle}
\newcommand{\hvec}[2]{\begin{pmatrix}#1&#2\end{pmatrix}}
\newcommand{\hVec}[3]{\begin{pmatrix}#1&#2&#3\end{pmatrix}}
\newcommand{\vvec}[2]{\begin{pmatrix}#1\\#2\end{pmatrix}}
\newcommand{\vVec}[3]{\begin{pmatrix}#1\\#2\\#3\end{pmatrix}}
\newcommand{\mat}[4]{\begin{pmatrix}#1&#2\\ #3&#4\end{pmatrix}}
\newcommand{\matt}[4]{\mat{#1}{#3}{#2}{#4}}
\newcommand{\Mat}[9]{\begin{pmatrix}{#1}&{#2}&{#3}\\{#4}&{#5}&{#6}\\{#7}&{#8}&{#9}\end{pmatrix}}
\newcommand{\Matt}[9]{\Mat{#1}{#4}{#7}{#2}{#5}{#8}{#3}{#6}{#9}} %matrix transpose
% Latex commands can only take 9 arguments, so need to cheat with a helper command to support > 9 args
\newcommand{\MAT}[7]{\begin{pmatrix}{#1}&{#2}&{#3}&{#4}\\{#5}&{#6}&{#7}&\MATHelper}
\newcommand{\MATHelper}[9]{{#1}\\{#2}&{#3}&{#4}&{#5}\\{#6}&{#7}&{#8}&{#9}\end{pmatrix}}
\newcommand{\Wedge}{\bigwedge\nolimits}
\newcommand{\topwedge}{\Wedge^{\mrm{top}}}
\newcommand{\Span}[1]{\t{span}\b{#1}}
\newcommand{\dual}[1]{#1^\vee}
\newcommand{\pdual}[1]{\p{#1}^\vee}
\DeclareMathOperator{\spn}{span}
\DeclareMathOperator{\trace}{tr}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\Vect}{Vect}
\DeclareMathOperator{\Alt}{Alt}

%% Abstract Algebra
\newcommand{\gen}[1]{\left\langle #1 \right\rangle}
\newcommand{\pres}[2]{\left\langle #1\left| #2 \right.\right\rangle}
\newcommand{\op}[0]{^\text{op}}
\newcommand{\freemod}[0]{R^{\oplus S}}
\newcommand{\units}[1]{#1^{\times}}
\newcommand{\punits}[1]{\units{\parens{#1}}}
\newcommand{\zunits}[1]{\punits{\zmod{#1}}}
\newcommand{\inv}[1]{#1^{-1}}
\newcommand{\pinv}[1]{\inv{\parens{#1}}}
\newcommand{\sinv}{\inv S}
\newcommand{\odd}[1]{#1^{\mrm{odd}}}
\newcommand{\invlim}{\varprojlim\limits}
\newcommand{\dirlim}{\varinjlim\limits}
\newcommand{\colim}{\operatorname{colim}}
\newcommand{\holim}{\operatorname{holim}}
\newcommand{\hocolim}{\operatorname{hocolim}}
\newcommand{\ses}[5]{
	\begin{tikzcd}[ampersand replacement=\&]
		0\arrow[r]\&#1\arrow[r, "#2"]\&#3\arrow[r, "#4"]\&#5\arrow[r]\&0
	\end{tikzcd}
}
\newcommand{\scmplx}[5]{ % single complex
	\begin{tikzcd}[ampersand replacement=\&]
		#1\arrow[r, "#2"]\&#3\arrow[r, "#4"]\&#5
	\end{tikzcd}
}
\newcommand{\lses}[5]{
	\begin{tikzcd}[ampersand replacement=\&]
		0\arrow[r]\&#1\arrow[r, "#2"]\&#3\arrow[r, "#4"]\&#5
	\end{tikzcd}
}
\newcommand{\rses}[5]{
	\begin{tikzcd}[ampersand replacement=\&]
		#1\arrow[r, "#2"]\&#3\arrow[r, "#4"]\&#5\arrow[r]\&0
	\end{tikzcd}
}
\newcommand{\ab}[1]{#1^{\mathrm{ab}}}
\newcommand{\un}[1]{#1^{\mrm{un}}}
\newcommand{\ur}[1]{#1^{\mrm{ur}}}
\newcommand{\tors}[1]{#1_{\mrm{tors}}}
\newcommand{\normal}{\triangleleft}
\newcommand{\irr}[1]{#1^{\mrm{irr}}} 
\newcommand{\inn}{\operatorname{inn}}
\DeclareMathOperator{\image}{image}
\DeclareMathOperator{\Hom}{Hom}	
\DeclareMathOperator{\Sur}{Sur}
\DeclareMathOperator{\Inj}{Inj}
\DeclareMathOperator{\Isom}{Isom}
\DeclareMathOperator{\Inn}{Inn}
\DeclareMathOperator{\Out}{Out}
\DeclareMathOperator{\sHom}{\mathscr{H\mkern-7mu}\textit{om}}
\DeclareMathOperator{\sExt}{\mathscr{E\mkern-4mu}\textit{xt}}
\DeclareMathOperator{\sEnd}{\mathscr{E\mkern-3mu}\textit{nd}}
\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\Tor}{Tor}
\DeclareMathOperator{\dertimes}{\overset L\otimes}
\DeclareMathOperator{\ann}{Ann}
\DeclareMathOperator{\ztensor}{\otimes_{\mathbb Z}}
\DeclareMathOperator{\zHom}{Hom_{\mathbb Z}}
\DeclareMathOperator{\qz}{\mathbb Q/\mathbb Z}
\DeclareMathOperator{\Sym}{Sym}
\DeclareMathOperator{\Ind}{Ind}
\DeclareMathOperator{\CoInd}{CoInd}
\DeclareMathOperator{\Res}{Res}
\DeclareMathOperator{\coker}{coker}
\DeclareMathOperator{\Ext}{Ext}
\renewcommand{\hom}{\operatorname H}
\DeclareMathOperator{\ZG}{\Z G}
\DeclareMathOperator{\sat}{sat}
\DeclareMathOperator{\Torsion}{Torsion}
\DeclareMathOperator{\lead}{lead}
\DeclareMathOperator{\qtensor}{\otimes_{\Q}}
\DeclareMathOperator{\Stab}{Stab}
\DeclareMathOperator{\im}{im}
\DeclareMathOperator{\ob}{ob}
\DeclareMathOperator{\Mor}{Mor}
\DeclareMathOperator{\Mod}{Mod}
\DeclareMathOperator{\CAlg}{Calg}
\DeclareMathOperator{\Alg}{Alg}
\DeclareMathOperator{\Irr}{Irr} % Do I want a separate section for representation theory?
\DeclareMathOperator{\Irrep}{Irrep}

%% Algebraic Number Theory/Field Theory
\newcommand{\qadj}[1]{\mathbb Q\left(#1\right)}
\newcommand{\qadjs}[1]{\qadj{\sqrt {#1}}}
\newcommand{\qadjns}[1]{\qadjs{-#1}}
\newcommand{\qbrac}[1]{\mathbb Q\left[#1\right]}
\newcommand{\qext}[1]{\qadj{#1}/\mathbb Q}
\newcommand{\zadj}[1]{\mathbb Z\left[#1\right]}
\newcommand{\zadjs}[1]{\zadj{\sqrt {#1}}}
\newcommand{\zadjns}[1]{\zadjs{-#1}}
\newcommand{\zmod}[1]{\mathbb Z/#1\mathbb Z}
\newcommand{\legendre}[2]{\left(\frac{#1}{#2}\right)}
\newcommand{\ints}[1]{\mathscr O_{#1}}
\newcommand{\zloc}[1]{\Z_{(#1)}}
\newcommand{\loc}[2]{#1_{\mathfrak #2}}
\newcommand{\idealloc}[2]{\mathfrak #2\loc{#1}{#2}}
\newcommand{\Norm}[1]{\left\|#1\right\|}
\newcommand{\Zmod}[1]{\frac{\Z}{#1\Z}}
\newcommand{\qadjzeta}[1]{\Q\left(\zeta_{#1}\right)}
\newcommand{\zadjzeta}[1]{\Z\left[\zeta_{#1}\right]}
\newcommand{\sep}[1]{#1_{\mathrm{sep}}}
\newcommand{\nabs}[0]{|\,\cdot\,|} % norm + absolute value
\newcommand{\gnabs}[0]{|g^{-1}(\,\cdot\,)|}
\newcommand{\ndot}[0]{{\|\,\cdot\,\|}}
\newcommand{\codiff}[1]{#1^*}
\newcommand{\compl}[1]{#1^{\wedge}} % Completion
\newcommand{\al}[1]{#1^{\mrm{al}}}
\newcommand{\rad}{\operatorname{rad}} % radical
\newcommand{\fieldtower}[6]{
    \begin{tikzcd}[ampersand replacement=\&]
	    {#1}\ar[d, dash, "{#5}" right]\ar[dd, dash, bend right, "{#4}" left]\\
	    {#2}\ar[d, dash, "{#6}" right]\\
	    {#3}
	\end{tikzcd}
}
\DeclareMathOperator{\Disc}{Disc}
\DeclareMathOperator{\norm}{N}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\Der}{Der}
\DeclareMathOperator{\disc}{disc}
\DeclareMathOperator{\Gal}{Gal}
\DeclareMathOperator{\knorm}{\norm_{K/\mathbb Q}}
\DeclareMathOperator{\Nm}{Nm}
\DeclareMathOperator{\zdisc}{disc_{\mathbb Z}}
\DeclareMathOperator{\ktrace}{\trace_{K/\mathbb Q}}
\DeclareMathOperator{\Inv}{Inv}
\DeclareMathOperator{\Br}{Br}
\DeclareMathOperator{\Char}{char}
\DeclareMathOperator{\denom}{denom}
\DeclareMathOperator{\Frac}{Frac}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\Fr}{Fr}
\DeclareMathOperator{\trdeg}{trdeg}
\DeclareMathOperator{\Tr}{Tr}
\DeclareMathOperator{\Pic}{Pic}
\DeclareMathOperator{\atensor}{\otimes_A} % Some of my commands are just stupid, but stick around because I care about backwards compatibility (for now)
\DeclareMathOperator{\ord}{ord}
\newcommand{\Frob}{\mrm{Frob}} % I need a consistent way of deciding when to use \mrm and when to use \opratorname
\DeclareMathOperator{\Vol}{Vol}
\DeclareMathOperator{\vol}{vol}
\DeclareMathOperator{\covol}{covol}
\renewcommand{\split}{\textrm{split}}
\newcommand{\Qbar}{{\overline\Q}}
\DeclareMathOperator{\lcm}{lcm}
\DeclareMathOperator{\Sel}{Sel}
\DeclareMathOperator{\Ell}{Ell}
% https://tex.stackexchange.com/questions/124738/i-just-want-to-write-sha-without-ruining-everything
\DeclareFontFamily{U}{wncy}{}
\DeclareFontShape{U}{wncy}{m}{n}{<->wncyr10}{}
\DeclareSymbolFont{mcy}{U}{wncy}{m}{n}
\DeclareMathSymbol{\Sha}{\mathord}{mcy}{"58} 
% End Sha stuff
\DeclareMathOperator{\Art}{Art}
\DeclareMathOperator{\Spl}{Spl}
\DeclareMathOperator{\sLat}{\mathscr{L\mkern-4mu}\textit{at}} % script L Lat

%% Modular Forms/Curves and automorphic stuff
\newcommand{\sump}{\sideset{}'\sum} % sum prime
\newcommand{\sums}{\sideset{}*\sum} % sum star
\newcommand{\prodp}{\sideset{}'\prod}
\newcommand{\bigotimesp}{\sideset{}'\bigotimes}
\newcommand{\otimesp}{\otimes'}
\newcommand{\slz}{\SL_2(\Z)}
\newcommand{\glp}{\GL_2^+}
% These were useful for one exercise long ago, but not for anything else
%\renewcommand{\sp}[1]{\sqbracks{\C/\Lambda_{#1},\frac1N+\Lam_{#1}}}
%\newcommand{\Sp}[2]{\sqbracks{\C/\Lambda_{#1},\frac1{#2}+\Lam_{#1}}}
%\newcommand{\spp}[1]{\sqbracks{\C/\Lambda_{#1},\parens{\frac{#1}N+\Lam_{#1},\frac1N+\Lam_{#1}}}}
%\newcommand{\Spp}[2]{\sqbracks{\C/\Lambda_{#1},\parens{\frac{#1}{#2}+\Lam_{#1},\frac1{#2}+\Lam_{#1}}}}
%\newcommand{\sg}[1]{\sqbracks{\C/\Lambda_{#1},\angles{\frac1N+\Lam_{#1}}}}
%\newcommand{\Sg}[2]{\sqbracks{\C/\Lambda_{#1},\angles{\frac1{#2}+\Lam_{#1}}}}
\newcommand{\pmI}{\bracks{\pm I}}

%% p-adic stuff
\newcommand{\caret}[1]{{#1}^{\wedge}}
\newcommand{\val}{\operatorname{val}}
\DeclareMathOperator{\LA}{LA}
\DeclareMathOperator{\Coh}{Coh}
\DeclareMathOperator{\ctensor}{\wh\otimes} % complete tensor
% https://tex.stackexchange.com/questions/148946/large-perp-symbol-and-proper-circled-perp-symbol
\makeatletter
\newcommand{\bigperp}{%
  \mathop{\mathpalette\bigp@rp\relax}%
  \displaylimits
}

\newcommand{\bigp@rp}[2]{%
  \vcenter{
    \m@th\hbox{\scalebox{\ifx#1\displaystyle2.1\else1.5\fi}{$#1\perp$}}
  }%
}
\makeatother
\DeclareMathOperator{\LCTVS}{LCTVS}

%% Group cohomology/class field theory
\DeclareMathOperator{\cores}{cor}
\DeclareMathOperator{\tatehom}{\wh\hom}

%% Point-Set Topology
\newcommand{\closure}[1]{\bar{#1}}
\newcommand{\clos}[1]{\overline{#1}}
\newcommand{\interior}[1]{\mathring{#1}}
%\newcommand{\open}{\overset{\text{open}}\subset} % "I care about backwards compatibility," he said. smh
\newcommand{\openset}{\overset{\text{open}}\subset}
\newcommand{\closedset}{\overset{\text{closed}}\subset}
\newcommand{\cp}[1]{\overline{\{#1\}}} % closure of point
\DeclareMathOperator{\Cl}{Cl}
\DeclareMathOperator{\Reg}{Reg}
\DeclareMathOperator{\cl}{cl}
\DeclareMathOperator{\SP}{SP}
\DeclareMathOperator{\Homeo}{Homeo}
\DeclareMathOperator{\Conf}{Conf}

%% Differential Geometry/Topology
\newcommand{\pderiv}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\pderivf}[2]{\partial #1/\partial #2}
\newcommand{\pderivd}[1]{\pderiv{}{#1}}
\newcommand{\pderivdf}[1]{\pderivf{}{#1}}
\newcommand{\pderivat}[2]{\left.\pderivd{#1}\right|_{#1=#2}}
\newcommand{\Pderiv}[3]{\frac{\partial #1}{\partial #2\partial #3}}
\newcommand{\dtwo}[1]{\pderiv{#1}x\,dx + \pderiv{#1}y\,dy}
\newcommand{\dthree}[1]{\dtwo{#1} + \pderiv{#1}z\,dz}
\newcommand{\smooth}[0]{C^\infty}
\newcommand{\del}[0]{\partial}
\newcommand{\vft}[2]{#1\pderivd{x_1}+#2\pderivd{x_2}} % vector (field) in \R^2
\newcommand{\dt}[0]{\d t}
\newcommand{\ds}[0]{\d s}
\newcommand{\du}[0]{\d u}
\newcommand{\dv}[0]{\d v}
\newcommand{\dw}[0]{\d w}
\newcommand{\dX}[0]{\d X}
\newcommand{\dx}[0]{\d x}
\newcommand{\dbx}[0]{\d\bar x}
\newcommand{\dy}[0]{\d y}
\newcommand{\dby}[0]{\d\bar y}
\newcommand{\dz}[0]{\d z}
\newcommand{\dbz}[0]{\d\bar z}
\newcommand{\df}[0]{\d f}
\newcommand{\dm}[0]{\d m}
\newcommand{\dn}[0]{\d n}
\newcommand{\dq}[0]{\d q}
\newcommand{\dk}[0]{\d k}
\newcommand{\da}[0]{\d a}
\newcommand{\db}[0]{\d b}
\newcommand{\dc}[0]{\d c}
\renewcommand{\dh}{\d h}
\newcommand{\dr}[0]{\d r}
\renewcommand{\d}{\mathrm d} % This had a \, in the front before. Will I regret removing it?
\DeclareMathOperator{\Tube}{Tube}
\DeclareMathOperator{\dvol}{dvol}
\DeclareMathOperator{\Todd}{Todd}
\DeclareMathOperator{\ch}{ch}
\DeclareMathOperator{\Diff}{Diff}

%% Algebraic Topology
\newcommand{\rel}[1]{\sqbracks{#1}_{\mrm{rel}}} % Relative fundamental class
\newcommand{\KSp}{\operatorname{KSp}}
\newcommand{\KH}{\operatorname{KH}}
\DeclareMathOperator{\mog}{mog}
\DeclareMathOperator{\Sq}{Sq}
\DeclareMathOperator{\Th}{Th}
\DeclareMathOperator{\Td}{Td}
\DeclareMathOperator{\simhom}{\hom^\Delta}
\DeclareMathOperator{\redhom}{\wt\hom}
\DeclareMathOperator{\RP}{\mathbb R\mathbb P}
\DeclareMathOperator{\CP}{\mathbb C\mathbb P}
\DeclareMathOperator{\fiber}{fiber}
\DeclareMathOperator{\hofiber}{hofiber}
\DeclareMathOperator{\Bun}{Bun}
\DeclareMathOperator{\Tot}{Tot}
\DeclareMathOperator{\sk}{sk}

%% Some common categories
\newcommand{\gr}{\mrm{gr}} % What is this and why is it here?
\newcommand{\Cat}{\mrm{Cat}}
\newcommand{\SSet}{\mrm{SSet}}
\newcommand{\CW}{\mrm{CW}}
\newcommand{\Ho}{\mrm{Ho}}
\newcommand{\Set}{\mrm{Set}}
\newcommand{\FinSet}{\mrm{FinSet}}
\newcommand{\Fin}{\mrm{Fin}}
\newcommand{\FinCov}{\mrm{FinCov}}
\newcommand{\Top}{\mrm{Top}}
\newcommand{\VB}{\mrm{VB}}
\newcommand{\Ban}{\mrm{Ban}} % Banach
\newcommand{\Rep}{\mrm{Rep}}
\newcommand{\SW}{\mrm{SW}}
\newcommand{\Pre}{\mrm{Pre}}
\newcommand{\MOR}{\mrm{MOR}}
\newcommand{\Groupoid}{\mrm{Groupoid}}
\newcommand{\Grp}{\mrm{Grp}}
\newcommand{\Grpoid}{\mrm{Grpoid}}
\newcommand{\Grpd}{\mrm{Grpd}}
\newcommand{\QCoh}{\mrm{QCoh}}
\newcommand{\Def}{\mrm{Def}} % deformations
\newcommand{\Ch}{\mrm{Ch}} % chain complexes
\newcommand{\CMon}{\mrm{CMon}}
\newcommand{\PSp}{\mrm{PSp}} % pre-spectra
\newcommand{\Fun}{\mrm{Fun}} % Functors

%% Lie Theory
\newcommand{\dg}{\d g}
\newcommand{\rs}[1]{#1^{\mrm{rs}}}
\newcommand{\der}[1]{#1^{\mrm{der}}}
\newcommand{\reg}[1]{#1^{\mrm{reg}}}
\newcommand{\GL}{\operatorname{GL}}
\newcommand{\Spin}{\operatorname{Spin}}
\newcommand{\Sp}{\operatorname{Sp}}
\newcommand{\GSp}{\operatorname{GSp}}
\newcommand{\SL}{\operatorname{SL}}
\newcommand{\PSL}{\operatorname{PSL}}
\newcommand{\PGL}{\operatorname{PGL}}
\newcommand{\SO}{\operatorname{SO}}
\newcommand{\PSO}{\operatorname{PSO}}
%\newcommand{\U}{\operatorname{U}}
\newcommand{\SU}{\operatorname{SU}}
\newcommand{\PSU}{\operatorname{PSU}}
\DeclareMathOperator{\Lie}{Lie}
\newcommand{\ad}{\mathrm{ad}}
\DeclareMathOperator{\Ad}{Ad}
\DeclareMathOperator{\FL}{FL}

%% Complex/Algebraic Geometry + Sheaf Theory
\newcommand{\msEX}[1]{\msE_X^{(#1)}}
\newcommand{\red}[1]{#1_{\mrm{red}}}
\newcommand{\cs}[1]{\parens{\ints{#1},\abs{#1}}} % Complex space
\newcommand{\derpush}[2]{#2_{*#1}}
\newcommand{\smp}[1]{{#1}^{\mrm{sm}}} % smooth points
\newcommand{\an}[1]{{#1}^{\mrm{an}}}
\renewcommand{\sharp}[1]{{#1}^\#}
\newcommand{\Jac}{\operatorname{Jac}}
\newcommand{\Gr}{\operatorname{Gr}}
\newcommand{\ind}{\operatorname{ind}} % What is ind?
\newcommand{\zar}[1]{#1_{\text{zar}}}
\newcommand{\bzar}[1]{#1_{\text{Zar}}} % Used to be called \bZar so some old files may not compile w/o small edits
\newcommand{\tet}{\text{\'et}} % text et
\newcommand{\et}[1]{#1_{\text{\'et}}}
\newcommand{\bet}[1]{#1_{\text{\'Et}}} % big etale
\newcommand{\etH}{\operatorname H_{\text{\'et}}}
\newcommand{\ethom}{\operatorname H_{\text{\'et}}}
\newcommand{\etpi}{\pi^{\text{\'et}}}
\newcommand{\fppf}[1]{#1_{\text{fppf}}} % Note sure if this (and \bfppf) are good inclusions
\newcommand{\bfppf}[1]{#1_{\text{Fppf}}}
\newcommand{\fhom}{\operatorname H_{\text{fppf}}}
\newcommand{\Hur}{\mrm{Hur}}
\newcommand{\Hilb}{\mrm{Hilb}}
\newcommand{\Quot}{\mrm{Quot}}
\newcommand{\bdel}{\bar\del}
\DeclareMathOperator{\height}{ht}
\DeclareMathOperator{\Spec}{\mbf{Spec}}
\DeclareMathOperator{\spec}{spec}
\DeclareMathOperator{\Proj}{Proj}
\DeclareMathOperator{\rProj}{\mbf{Proj}} % relative Proj
\DeclareMathOperator{\PAb}{PAb}
\DeclareMathOperator{\Ab}{Ab}
\DeclareMathOperator{\pker}{pker}
\DeclareMathOperator{\pim}{pim}
\DeclareMathOperator{\pcoker}{pcoker}
\DeclareMathOperator{\Et}{Et}
\DeclareMathOperator{\Div}{Div}
\DeclareMathOperator{\CaCl}{CaCl}
\DeclareMathOperator{\res}{res}
\DeclareMathOperator{\cechhom}{\check{H}}
\DeclareMathOperator{\chom}{\cechhom}
\DeclareMathOperator{\kod}{kod}
\DeclareMathOperator{\Sing}{Sing}
\DeclareMathOperator{\Alb}{Alb}
\DeclareMathOperator{\NS}{NS}
\DeclareMathOperator{\Ht}{ht}
\DeclareMathOperator{\codim}{codim}
\DeclareMathOperator{\AffSch}{AffSch}
\DeclareMathOperator{\Sch}{Sch}
\DeclareMathOperator{\Bl}{Bl}
\DeclareMathOperator{\Sm}{Sm}
\DeclareMathOperator{\Psh}{Psh}
\DeclareMathOperator{\Sh}{Sh}

%% A1 Homotopy Theory
\DeclareMathOperator{\GW}{GW}

%% Analysis
\newcommand{\meas}{m_{\star}}
\newcommand{\abs}[1]{\left|#1\right|}
\newcommand{\invabs}[1]{\inv{\abs{#1}}}
\newcommand{\dabs}[1]{\left\|#1\right\|}
\let\templim\lim
\renewcommand{\lim}{\templim\limits}
\DeclareMathOperator{\BV}{BV}

% Complex Analysis
\DeclareMathOperator\Arg{Arg}
\DeclareMathOperator\cotan{cotan}

%% Quantum Mechanics/Computing
\newcommand{\ket}[1]{\left|#1\right>}
\newcommand{\keteps}{\ket\eps}

%% Cryptography
\newcommand{\bits}{\{0,1\}}
\newcommand{\concat}{\,\|\,}
\newcommand{\uniform}{\xleftarrow R}
\DeclareMathOperator{\Adv}{Adv}
\DeclareMathOperator{\parity}{parity}
\DeclareMathOperator{\reverse}{reverse}
\DeclareMathOperator{\EXP}{EXP}
\DeclareMathOperator{\poly}{poly}
\DeclareMathOperator{\perm}{perm}
\DeclareMathOperator{\Commit}{Commit}
\DeclareMathOperator{\negl}{negl}
\DeclareMathOperator{\PRF}{PRFAdv}
\DeclareMathOperator{\SCPRF}{SC-PRF}
\DeclareMathOperator{\DDH}{DDHAdv}
\DeclareMathOperator{\pub}{pub}
\DeclareMathOperator{\priv}{priv}
\DeclareMathOperator{\key}{key}

%% Complexity Theory
\DeclareMathOperator{\NP}{NP}
\DeclareMathOperator{\NL}{NL}
\DeclareMathOperator{\coNL}{coNL}
\DeclareMathOperator{\coNP}{coNP}
\DeclareMathOperator{\TIME}{TIME}
\DeclareMathOperator{\ccP}{P} % cc = complexity class
\DeclareMathOperator{\SAT}{SAT}
\DeclareMathOperator{\UNSAT}{UNSAT}
\DeclareMathOperator{\Perm}{Perm} % Permanent of a matrix
\DeclareMathOperator{\MAJPP}{MAJPP}
\DeclareMathOperator{\ccRP}{RP}
\DeclareMathOperator{\coRP}{coRP}
\DeclareMathOperator{\ZPP}{ZPP}

%% Logic
\newcommand{\biglor}{\bigvee}
\newcommand{\bigland}{\bigwedge}

%% Machine Learning
\newcommand{\grad}{\nabla}
\newcommand{\Ith}[2]{{#1}^{\left(#2\right)}}
\newcommand{\ith}[1]{\Ith{#1}i}
\newcommand{\Itht}[2]{(\Ith{#1}{#2})^T}
\newcommand{\Ithi}[2]{(\Ith{#1}{#2})^{-1}}
\newcommand{\itht}[1]{(\ith{#1})^T}
\newcommand{\Layer}[2]{#1^{\left[#2\right]}}
\newcommand{\KL}[2]{\operatorname{KL}\left(#1\left\|\,#2\right.\right)}

%% Probability/Statistics
\newcommand{\prb}[1]{P\left\{#1\right\}}
\DeclareMathOperator{\Cov}{Cov}
\DeclareMathOperator{\Var}{Var}
\DeclareMathOperator{\Corr}{Corr}

%% Diagrams
\newcommand{\commsquare}[8]{
	\begin{tikzcd}[ampersand replacement=\&]
	{\displaystyle #1}\ar[r, "{#2}"]\ar[d, "{#4}" left]\&{\displaystyle #3}\ar[d, "{#5}" right]\\
	{\displaystyle #6}\ar[r, "{#7}" above]\&{\displaystyle #8}
	\end{tikzcd}
}
\newcommand{\pullback}[6]{
	\begin{tikzcd}[ampersand replacement=\&]
	{\displaystyle #1}\ar[r]\ar[d]\arrow[dr, phantom, "\ulcorner", very near start]\&{\displaystyle #2}\ar[d, "{#3}" right]\\
	{\displaystyle #4}\ar[r, "{#5}" above]\&{\displaystyle #6}
	\end{tikzcd}
}
\newcommand{\pushout}[6]{
	\begin{tikzcd}[ampersand replacement=\&]
	{\displaystyle #1}\ar[r, "{#2}"]\ar[d, "{#4}" left]\&{\displaystyle #3}\ar[d]\\
	{\displaystyle #5}\ar[r]\&{\displaystyle #6}\ar[ul, phantom, "\lrcorner", very near start]
	\end{tikzcd}
}
\newcommand{\barecommsquare}[4]{\commsquare{#1}{}{#2}{}{}{#3}{}{#4}}
\newcommand{\liftsquare}[9]{
	\begin{tikzcd}[ampersand replacement=\&]
	{\displaystyle #1}\ar[r, "{#2}"]\ar[d, "{#4}" left]\&{\displaystyle #3}\ar[d, "{#5}" right]\\
	{\displaystyle #6}\ar[r, "{#7}" above]\ar[ur, dashed, "{#9}" sloped]\&{\displaystyle #8}
	\end{tikzcd}
}
\newcommand{\twocommsquare}[9]{
    \begin{tikzcd}[ampersand replacement=\&]
        {\displaystyle #1}\ar[r, "{#2}"]\ar[d, "{#4}" left]\&{\displaystyle #3}\ar[d, "{#5}" right]\\
        {\displaystyle #6}\ar[r, "{#7}" above]\&{\displaystyle #8}
        \ar[Rightarrow, from=u, to=l, "{#9}"', shorten >= 10pt, shorten <= 10pt]
    \end{tikzcd}
}
\newcommand{\baretwocommsquare}[4]{\twocommsquare{#1}{}{#2}{}{}{#3}{}{#4}{}}
\newcommand{\mapover}[6]{
    \begin{tikzcd}[ampersand replacement=\&]
        {\displaystyle #1}\ar[rr, "{#2}" above]\ar[dr, "{#4}"']\&\&{#3}\ar[dl, "{#5}"]\\
        \&{\displaystyle #6}
    \end{tikzcd}
}
\newcommand{\compdiag}[6]{ % composition diagram
    \begin{tikzcd}[ampersand replacement=\&]
        {\displaystyle #1}\ar[r, "{#2}" below]\ar[rr, bend left, "{#6}" above]\&{\displaystyle #3}\ar[r, "{#4}" below]\&{\displaystyle #5}
    \end{tikzcd}
}
\newcommand{\mapwithsect}[4]{ % map with section
    \begin{tikzcd}[ampersand replacement=\&]
        {\displaystyle #1}\ar[d, "{#2}" left]\\
        {\displaystyle #3}\ar[u, bend right, "{#4}" right]
    \end{tikzcd}
}
\newcommand{\correspondence}[5]{ % maybe I should have called this \zigzag
    \begin{tikzcd}[ampersand replacement=\&]
        \&{\displaystyle #1}\ar[dl, "{#2}"']\ar[dr, "{#3}"]\\
        {\displaystyle #4}\&\&{\displaystyle #5}
    \end{tikzcd}
}
\newcommand{\mapdown}[4]{
    \begin{tikzcd}[ampersand replacement=\&]
        {\displaystyle #1}\ar[d, "{#2}" left, "{#3}" right]\\
        {\displaystyle #4}
    \end{tikzcd}
}
\newcommand{\galoisdiamond}[8]{
    \begin{tikzcd}[ampersand replacement=\&, every arrow/.append style={dash}]
        \&{\displaystyle #1}\ar[dl, "{#2}"']\ar[dr, "{#3}"]\\
        {\displaystyle #4}\ar[dr, "{#6}"']\&\&{\displaystyle #5}\ar[dl, "{#7}"]\\
        \&{\displaystyle #8}
    \end{tikzcd}
}
\newcommand{\baregaloisdiamond}[4]{\galoisdiamond{#1}{}{}{#2}{#3}{}{}{#4}}

%% Limit type things

%% Letters/Fonts
\renewcommand{\phi}{\varphi}
\newcommand{\mfp}{\mathfrak p}
\newcommand{\mfm}{\mathfrak m}
\newcommand{\mfn}{\mathfrak n}
\newcommand{\mfX}{\mathfrak X}
\newcommand{\mfg}{\mathfrak g}
\newcommand{\mfk}{\mathfrak k}
\newcommand{\mfh}{\mathfrak h}
\newcommand{\mfz}{\mathfrak z}
\newcommand{\mfH}{\mathfrak H}
\newcommand{\mft}{\mathfrak t}
\newcommand{\mfD}{\mathfrak D}
\newcommand{\mfd}{\mathfrak d}
\newcommand{\mff}{\mathfrak f}
\newcommand{\mfgl}{\mathfrak{gl}}
\newcommand{\mfsl}{\mathfrak{sl}}
\newcommand{\mfso}{\mathfrak{so}}
\newcommand{\mfsu}{\mathfrak{su}}
\newcommand{\mfsp}{\mathfrak{sp}}
\newcommand{\mfo}{\mathfrak o}
\newcommand{\mfu}{\mathfrak u}
\newcommand{\mfU}{\mathfrak U}
\newcommand{\mfM}{\mathfrak M}
\newcommand{\mfs}{\mathfrak s}
\newcommand{\mbf}{\mathbf}
\newcommand{\mbfx}{\mathbf x}
\newcommand{\mbfy}{\mathbf y}
\newcommand{\mbfz}{\mathbf z}
\newcommand{\mbfi}{\mathbf i}
\newcommand{\mbfj}{\mathbf j}
\newcommand{\mbfk}{\mathbf k}
\newcommand{\mbfe}{\mathbf e}
\newcommand{\mbff}{\mathbf f}
\newcommand{\mbfh}{\mathbf h}
\newcommand{\mbfU}{\mathbf U}
\newcommand{\mbfV}{\mathbf V}
\newcommand{\msO}{\mathscr O}
\newcommand{\mscr}{\mathscr}
\newcommand{\mf}{\mathfrak}
\newcommand{\mfc}{\mf c}
\newcommand{\msI}{\mathscr I}
\newcommand{\msJ}{\mathscr J}
\newcommand{\msP}{\mathscr P}
\newcommand{\msA}{\mathscr A}
\newcommand{\msB}{\mathscr B}
\newcommand{\msC}{\mathscr C}
\newcommand{\msK}{\mathscr K}
\newcommand{\msCC}{\msC\msC}
\newcommand{\msFG}{\msF\msG}
\newcommand{\msF}{\ms F}
\newcommand{\msG}{\ms G}
\newcommand{\msH}{\ms H}
\newcommand{\msL}{\ms L}
\newcommand{\msM}{\ms M}
\newcommand{\msN}{\ms N}
\newcommand{\msV}{\ms V}
\newcommand{\msW}{\ms W}
\newcommand{\msX}{\ms X}
\newcommand{\ms}{\mathscr}
\newcommand{\msU}{\ms U}
\newcommand{\mfq}{\mf q}
\newcommand{\mfP}{\mf P}
\newcommand{\mfQ}{\mf Q}
\newcommand{\mc}{\mathcal} % Change to pazocal if you ever go back to using calrsfs for some reason
\newcommand{\mcA}{\mc A}
\newcommand{\mcB}{\mc B}
\newcommand{\mcD}{\mc D}
\newcommand{\mcK}{\mc K}
\newcommand{\mcI}{\mc I}
\newcommand{\mcP}{\mc P}
\newcommand{\mcR}{\mc R}
\newcommand{\mcT}{\mc T}
\newcommand{\mcV}{\mc V}
\newcommand{\mcU}{\mc U}
\newcommand{\mcW}{\mc W}
\newcommand{\mcF}{\mc F}
\newcommand{\mcE}{\mc E}
\newcommand{\mcJ}{\mc J}
\newcommand{\mcX}{\mc X}
\newcommand{\mcY}{\mc Y}
\newcommand{\mcZ}{\mc Z}
\newcommand{\mfa}{\mf a}
\newcommand{\mfb}{\mf b}
\newcommand{\mbb}{\mathbb}
\newcommand{\msR}{\ms R}
\newcommand{\msS}{\ms S}
\newcommand{\mcH}{\mc H}
\newcommand{\mcG}{\mc G}
\newcommand{\mcS}{\mc S}
\newcommand{\mcM}{\mc M}
\newcommand{\mcN}{\mc N}
\newcommand{\mcL}{\mc L}
\newcommand{\mcC}{\mc C}
\newcommand{\mrm}{\mathrm}
\newcommand{\Lam}{\Lambda}
%\renewcommand{\S}{\mathbb S}
\newcommand{\F}{\mathbb F}
\newcommand{\Q}{\mathbb Q}
\newcommand{\Z}{\mathbb Z}
\newcommand{\R}{\mathbb R}
\newcommand{\C}{\mathbb C}
\newcommand{\E}{\mathbb E}
\newcommand{\N}{\mathbb N}
\newcommand{\T}{\mathbb T}
\newcommand{\A}{\mathbb A}
\newcommand{\G}{\mathbb G}
\newcommand{\K}{\mathbb K}
\renewcommand{\H}{\mathbb H}
\newcommand{\I}{\mathbb I}
\newcommand{\eps}{\varepsilon}
\newcommand{\vphi}{\varphi}
\renewcommand{\tau}{\uptau}
\renewcommand{\P}{\mathbb P}
\newcommand{\msE}{\ms E}
\renewcommand{\a}{\alpha}
\renewcommand{\b}{\beta}
\newcommand{\me}{\matheuler}
\newcommand{\meA}{\me A}
\newcommand{\meB}{\me B}
\newcommand{\meC}{\me C}
\newcommand{\meD}{\me D}
\newcommand{\meE}{\me E}
\newcommand{\meF}{\me F}
\newcommand{\meG}{\me G}
\newcommand{\meH}{\me H}
\newcommand{\meM}{\me M}
\newcommand{\meN}{\me N}
\newcommand{\meP}{\me P}
\newcommand{\meQ}{\me Q}
\newcommand{\meR}{\me R}
\newcommand{\meS}{\me S}
\newcommand{\meT}{\me T}
\newcommand{\meU}{\me U}
\newcommand{\meV}{\me V}
\newcommand{\meW}{\me W}
\newcommand{\meX}{\me X}
\newcommand{\meY}{\me Y}
\newcommand{\meZ}{\me Z}


%% Grouping Operators
\newcommand{\floor}[1]{\left\lfloor#1\right\rfloor}
\newcommand{\ceil}[1]{\left\lceil#1\right\rceil}
\newcommand{\parens}[1]{\left(#1\right)}
\newcommand{\p}[1]{\left(#1\right)}
\newcommand{\pfrac}[2]{\parens{\frac{#1}{#2}}}
\newcommand{\brackets}[1]{\left\{#1\right\}}
\newcommand{\bracks}[1]{\brackets{#1}}
\renewcommand{\b}{\bracks} % hopefully I never need a bar under accent
\newcommand{\sqbracks}[1]{\left[#1\right]}
\newcommand{\sq}{\sqbracks}
\newcommand{\angles}[1]{\left\langle#1\right\rangle}
\newcommand{\coint}[2]{\left[#1,#2\right)} % Closed, open interval
\newcommand{\dsqbracks}[1]{\left\llbracket#1\right\rrbracket}
\newcommand{\dsq}{\dsqbracks}
\newcommand{\dparens}[1]{\p{\!\p{#1}\!}}

%% Arrows
\newcommand{\xlongleftarrow}[1]{\overset{#1}{\longleftarrow}}
\newcommand{\xlongrightarrow}[1]{\overset{#1}{\longrightarrow}}
\newcommand{\from}{\leftarrow}
\newcommand{\fromm}{\longleftarrow}
\newcommand{\xto}{\xrightarrow}
\newcommand{\xfrom}{\xleftarrow}
\newcommand{\too}{\longrightarrow}
\newcommand{\xtoo}{\xlongrightarrow}
\newcommand{\iso}{\xto\sim}
\newcommand{\isoo}{\xtoo\sim}
\newcommand{\xiso}[1]{\overset{#1}\iso}
\newcommand{\xisoo}[1]{\overset{#1}\isoo}
\newcommand{\fiso}{\xfrom\sim}
\newcommand{\xfiso}[1]{\overset{#1}\fiso}
\newcommand{\into}{\hookrightarrow}
\newcommand{\xinto}[1]{\overset{#1}\into}
\newcommand{\finto}{\hookleftarrow}
\newcommand{\xfinto}[1]{\overset{#1}\finto}
\newcommand{\intoo}{\longhookrightarrow}
\newcommand{\xintoo}[1]{\overset{#1}\intoo}
\newcommand{\fintoo}{\longhookleftarrow}
\newcommand{\xfintoo}[1]{\overset{#1}\fintoo}
\newcommand{\onto}{\twoheadrightarrow}
\newcommand{\xonto}[1]{\overset{#1}\onto}
\newcommand{\fonto}{\twoheadleftarrow}
\newcommand{\xfonto}[1]{\overset{#1}\fonto}
%\newcommand{\ontoo}{\longtwoheadrightarrow}
%\newcommand{\xontoo}[1]{\overset{#1}\ontoo}
%\newcommand{\fontoo}{\longtwoheadleftarrow}
%\newcommand{\xfontoo}[1]{\overset{#1}\fontoo}
\newcommand{\bij}{\leftrightarrow}
\newcommand{\biij}{\longleftrightarrow}
\newcommand{\longbij}{\biij}
\newcommand{\xbij}[1]{\overset{#1}\bij}
\newcommand{\dashto}{\dashrightarrow}
\newcommand{\cofib}{\rightarrowtail}
\newcommand{\toto}{\rightrightarrows}
\newcommand{\xtoto}[2][]{\overset{#2}{\underset{#1}\toto}}
\newcommand{\fromfrom}{\leftleftarrows}
\newcommand{\tofrom}{\rightleftarrows}
\newcommand{\fromto}{\leftrightarrows}
% https://tex.stackexchange.com/questions/195025/how-to-get-the-opposite-direction-of-rightsquigarrow
\makeatletter
\providecommand{\leftsquigarrow}{%
  \mathrel{\mathpalette\reflect@squig\relax}%
}
\newcommand{\reflect@squig}[2]{%
  \reflectbox{$\m@th#1\rightsquigarrow$}%
}
\makeatother

%% Misc
\newcommand{\Avg}[0]{\operatorname{Avg}}
\newcommand{\actson}{\curvearrowright}
\newcommand{\actedon}{\curvearrowleft}
\newcommand{\conj}{\overline}
\newcommand*{\rom}[1]{\textup{\uppercase\expandafter{\romannumeral#1}}}
\newcommand{\tbf}{\textbf}
\newcommand{\bp}[1]{\tbf{(#1)}} % bold parens
\newcommand{\Item}[1]{\item[\tbf{(#1)}]}
\newcommand{\jota}{\reflectbox{$\iota$}}
\newcommand{\atoi}{\jota}
\newcommand{\omittedproof}{\begin{proof}Omitted\end{proof}}
\newcommand{\sm}{\setminus}
\newcommand{\bs}{\backslash}
\renewcommand{\l}{\ell}
\newcommand{\st}{\tilde} % small tilde
\newcommand{\wt}{\widetilde}
\newcommand{\sh}{\hat} % small hat
\newcommand{\wh}{\widehat}
\newcommand{\ul}{\underline}
\newcommand{\vsubseteq}{\rotatebox{90}{$\subseteq$}}
\renewcommand{\ast}[1]{#1^*}
\newcommand{\twocases}[3]{
	\begin{cases}
		\hfill\displaystyle #1\hfill&\text{if }\displaystyle #2\\
		\hfill\displaystyle #3\hfill&\text{otherwise.}
	\end{cases}
}
\newcommand{\threecases}[5]{
	\begin{cases}
		\hfill\displaystyle #1\hfill&\text{if }\displaystyle #2\\
		\hfill\displaystyle #3\hfill&\text{if }\displaystyle #4\\
		\hfill\displaystyle #5\hfill&\text{otherwise.}
	\end{cases}
}
\newcommand{\Twocases}[4]{
	\begin{cases}
		\hfill\displaystyle #1\hfill&\text{if }\displaystyle #2\\
		\hfill\displaystyle #3\hfill&\text{if }\displaystyle #4
	\end{cases}
}
\newcommand{\Threecases}[6]{
	\begin{cases}
		\hfill\displaystyle #1\hfill&\text{if }\displaystyle #2\\
		\hfill\displaystyle #3\hfill&\text{if }\displaystyle #4\\
		\hfill\displaystyle #5\hfill&\text{if }\displaystyle #6
	\end{cases}
}
\newcommand{\push}[1]{#1_*}
\newcommand{\ppush}[1]{\p{#1}_*}
\newcommand{\pull}[1]{#1^*}
\newcommand{\ppull}[1]{\p{#1}^*}
\newcommand{\by}{\times}
\newcommand{\mapdesc}[5]{
	\begin{matrix}
		\ifblank{#1}{}{\displaystyle#1:}&\displaystyle#2&\longrightarrow&\displaystyle#3\\
		&\displaystyle#4&\longmapsto&\displaystyle #5
	\end{matrix}
}
%\newcommand{\mapdesc}[5]{
%    \begin{alignat}{3}
%        \ifblank{#1}{}{#1:} &#2 &&\longrightarrow &&#3\\
%        &#4 &&\longmapsto &&#5
%    \end{alignat}
%}
\renewcommand{\div}{\operatorname{div}} % Might regret this one day
\newcommand*{\cube}{\mbox{\mancube}}
\DeclareMathOperator{\sign}{sign}
\renewcommand{\Re}{\operatorname{Re}}
\renewcommand{\Im}{\operatorname{Im}}
\newcommand{\nimplies}{\nRightarrow}
\renewcommand{\bar}{\overline}
\DeclareMathOperator{\Dom}{Dom}
\DeclareMathOperator{\Map}{Map}
\DeclareMathOperator{\supp}{supp}
\DeclareMathOperator{\Cont}{Cont}
\DeclareMathOperator{\Open}{Open}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\Id}{Id}
\DeclareMathOperator{\pr}{pr}
\DeclareMathOperator*{\argmin}{\arg\min}
\DeclareMathOperator*{\argmax}{\arg\max}


%% Text
\newcommand{\xxsspacing}[0]{\hspace*{3pt}}
\newcommand{\xsspacing}[0]{\hspace*{10pt}}
\newcommand{\sspacing}[0]{\hspace*{25pt}}
\newcommand{\mspacing}[0]{\hspace*{50pt}}
\newcommand{\centered}[1]{\begin{center}#1\end{center}}
\newcommand{\Text}[2]{\text{#2 #1 #2}} % e.g. \Text{and}\xsspacing
\newcommand{\tand}{\,\text{ and }\,} % text and
\newcommand{\tor}{\,\text{ or }\,}
\newcommand{\twhen}{\,\text{ when }\,}
\newcommand{\twhere}{\,\text{ where }\,}
\newcommand{\twith}{\,\text{ with }\,}
\newcommand{\twhile}{\,\text{ while }\,}
\newcommand{\tif}{\,\text{ if }\,}
\newcommand{\tas}{\,\text{ as }\,}
\newcommand{\tfor}{\,\text{ for }\,}
\newcommand{\tso}{\,\text{ so }\,}
\newcommand{\tbut}{\,\text{ but }\,}
\newcommand{\tcomma}{\text{, }\,\,}
\newcommand{\tthen}{\,\text{ then }\,}
\newcommand{\tvia}{\,\text{ via }\,}
\newcommand{\tforall}{\,\text{ for all }\,}
\newcommand{\tforany}{\,\text{ for any }\,}
\newcommand{\tforsome}{\,\text{ for some }\,}
\newcommand{\tsince}{\,\text{ since }\,}
\newcommand{\totherwise}{\,\text{ otherwise }\,}
\newcommand{\texists}{\,\text{ exists }\,}
\renewcommand\t\text % Not sure if I want to keep this (Update: I do)

%% Marginal Notes
\newcommand{\confusion}[1]{\todo[color=red!70]{#1}}
\newcommand{\furtherreading}[1]{\todo[color=blue!30, inline]{#1}}
\newcommand{\thought}[1]{\todo[color=green!50]{#1}}
\newcommand{\question}[1]{\todo[color=purple!60]{Question: #1}}
\newcommand{\answer}[1]{\todo[color=gray!20]{Answer: #1}}
\newcommand{\dolater}[1]{\todo[color=blue!50]{TODO: #1}}
\newcommand{\remember}[1]{\todo[color=yellow!60]{Remember: #1}}
\newcommand{\errata}[1]{\todo[color=cyan!70]{Errata: #1}}

%% Index Stuff
\newcommand{\emphasize}[1]{\textbf{#1}}
\newcommand{\important}[1]{\textit{#1}}
\newcommand\noteworthy\important
\newcommand{\Index}[1]{#1\index{#1}}
\newcommand{\define}[1]{\emphasize{#1}\index{#1}}
\newcommand{\Define}[2]{\emphasize{#1}\index{#2}}

%% Formatting
\newcommand{\Section}[1]{\newpage\section{#1}}
\newcommand{\Subsection}[1]{\newpage\subsection{#1}}
\newcommand{\Subusbsection}[1]{\newpage\subsubsection{#1}}

%% Randomness
\pgfmathdeclarerandomlist{thuses}{{Thus}{Therefore}{As such}{As we wished}{By this great fortune}{Alors}{Donc}{Following this thread}{Consequently}{Thusforth}{Rejoice}{This can only mean one thing...}{Ergo}}
\newcommand\Thus{\pgfmathrandomitem\z{thuses}\z}
\pgfmathdeclarerandomlist{fibers}{{fiber}{fibre}}
\newcommand\fibre{\pgfmathrandomitem\z{fibers}\z\,}
\pgfmathdeclarerandomlist{wewins}{{we win}{it's over}{all is good}{victory has been achieved}{we've crossed the finish line}{we're happy campers}{we've done it}{that's a wrap}{we have the high ground}}
\newcommand\wewin{\pgfmathrandomitem\z{wewins}\z}
\newcommand\Proven{\Thus, \wewin}

%% Everything Else

% https://tex.stackexchange.com/questions/251135/group-actions-in-diagrams
\tikzset{%
	symbol/.style={%
		,draw=none
		,every to/.append style={%
			edge node={node [sloped, allow upside down, auto=false]{$#1$}}}
	}
}

% https://tex.stackexchange.com/questions/44425/isomorphisms-in-commutative-diagrams-in-tikz
\newcommand*{\isoarrow}[1]{\arrow[#1,"\rotatebox{90}{\(\sim\)}"]}

% https://tex.stackexchange.com/questions/103013/is-there-a-renewtheorem-equivalent-of-renewcommand-using-amsthm-and-not-ntheo
\makeatletter
\def\renewtheorem#1{%
	\expandafter\let\csname#1\endcsname\relax
	\expandafter\let\csname c@#1\endcsname\relax
	\gdef\renewtheorem@envname{#1}
	\renewtheorem@secpar
}
\def\renewtheorem@secpar{\@ifnextchar[{\renewtheorem@numberedlike}{\renewtheorem@nonumberedlike}}
\def\renewtheorem@numberedlike[#1]#2{\newtheorem{\renewtheorem@envname}[#1]{#2}}
\def\renewtheorem@nonumberedlike#1{  
	\def\renewtheorem@caption{#1}
	\edef\renewtheorem@nowithin{\noexpand\newtheorem{\renewtheorem@envname}{\renewtheorem@caption}}
	\renewtheorem@thirdpar
}
\def\renewtheorem@thirdpar{\@ifnextchar[{\renewtheorem@within}{\renewtheorem@nowithin}}
\def\renewtheorem@within[#1]{\renewtheorem@nowithin[#1]}
\makeatother

% https://tex.stackexchange.com/questions/33078/frame-with-only-crosses-in-two-opposite-corners
\DeclareDocumentEnvironment{MyFrame}{O{1cm}O{0.4pt}O{0.8cm}O{black}O{3}O{2ex}}
{\par\hfill\rlap{%
		\bgroup\color{#4}%
		\hskip-\dimexpr#1-#3\relax\rule{#1}{#2}%
		\hskip-\dimexpr#1/#5\relax\rule[-\dimexpr#1-\dimexpr#1/#5\relax]{#2}{#1}%
		\egroup
	}%
	\vskip-\dimexpr#1/#5+\dimexpr#1/#5-#6\relax%
}
{\par\nobreak\offinterlineskip\vskip-\dimexpr#1/#5+\dimexpr#1/#5-#6\relax\noindent%
	\hskip-#3\bgroup\color{#4}%
	\rule{#1}{#2}\hskip-\dimexpr#1-\dimexpr#1/#5-#2\relax%
	\rule[-\dimexpr#1/#5-#2\relax]{#2}{#1}\egroup\par
}

\newenvironment{aside}
{\begin{MyFrame}[0.6cm][5pt][0.6cm][black][4][0ex]}
	{\end{MyFrame}}

% Always \theoremstyle{plain}
\newtheorem{innercustomgeneric}{\customgenericname}
\providecommand{\customgenericname}{}
\newcommand{\newcustomtheorem}[2]{%
	\newenvironment{#1}[1]
	{%
		\renewcommand\customgenericname{#2}%
		\renewcommand\theinnercustomgeneric{##1}%
		\innercustomgeneric
	}
	{\endinnercustomgeneric}
}

\theoremstyle{plain}
\newtheorem{thm}{Theorem}
\newtheorem{lemma}[thm]{Lemma}
\newtheorem{cor}[thm]{Corollary}
\newtheorem{conject}[thm]{Conjecture}
\renewtheorem{conj}[thm]{Conjecture}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{heur}[thm]{Heuristic}
\newtheorem{qn}[thm]{Question}
\newtheorem{openqn}[thm]{Open Question}
\newtheorem{claim}[thm]{Claim}
\newtheorem{prob}{Problem}
\newtheorem{cexc}{Exercise} % Conrad Exercise
\newtheorem{ho}{Handout}
\newtheorem{univ}{Univseral Property}
\newcustomtheorem{Prob}{Problem}
\newcustomtheorem{Exc}{Theoretical Exercise}

\renewcommand\thecexc{\Alph{cexc}}

\theoremstyle{definition}
\newtheorem{defn}[thm]{Definition}
\newtheorem{cond}[thm]{Conditions}
\newtheorem{notn}[thm]{Notation}
\newtheorem{anotn}[thm]{Abuse of Notation}
\newtheorem{san}[thm]{Sanity Check}
\newtheorem{rec}[thm]{Recall}
\newtheorem*{fact}{Fact}
\newtheorem*{ex}{Example}
\newtheorem*{assump}{Assumption}
\newtheorem*{intuition}{Intuition}
\newtheorem*{princex}{Principal Example}
\newtheorem*{nonex}{Non-example}
\newtheorem{warn}[thm]{Warning}
\newtheorem*{slogan}{Slogan}
\newtheorem*{ans}{Answer}
\newtheorem*{resp}{Response}
\newtheorem*{hist}{History}
\newtheorem*{appl}{Application}

\theoremstyle{remark}
\newtheorem{rem}[thm]{Remark}
\newtheorem{construct}[thm]{Construction}
\newtheorem{obs}[thm]{Observation}
\newtheorem{note}{Note}
\newtheorem*{counterex}{Counterexample}
\newtheorem*{exc}{Exercise}
\newtheorem*{mor}{Moral}
\newtheorem*{set}{Setup}
\newtheorem*{expln}{Explanation}
\newtheorem*{descrip}{Description}
\newtheorem*{mot}{Motivation}
\newtheorem*{goal}{Goal}
\newtheorem*{conv}{Convention}
\newtheorem*{plan}{Plan}
\newtheorem*{comp}{Computation}

\renewcommand{\qedsymbol}{$\blacksquare$}
